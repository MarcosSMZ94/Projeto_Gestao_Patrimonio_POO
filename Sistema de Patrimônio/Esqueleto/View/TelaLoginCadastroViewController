package View;

import Controller.TelaLoginCadastroController;
import Model.Administrador;
import Model.Requisitante;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.TextField;
import javafx.scene.control.Alert;
import javafx.scene.control.Alert.AlertType;

public class TelaLoginCadastroViewController {

    @FXML
    private TextField loginAlunoField;
    
    @FXML
    private TextField senhaAlunoField;
    
    @FXML
    private TextField loginAdminField;
    
    @FXML
    private TextField senhaAdminField;
    
    @FXML
    private Button logarAlunoButton;
    
    @FXML
    private Button logarAdminButton;
    
    @FXML
    private Button cadastrarAlunoButton;
    
    @FXML
    private Button cadastrarAdminButton;

    private TelaLoginCadastroController controller;

    public TelaLoginCadastroViewController(TelaLoginCadastroController controller) {
        this.controller = controller;
    }

    @FXML
    public void initialize() {
        // Event handlers para os botões de login e cadastro

        logarAlunoButton.setOnAction(event -> loginRequisitante());
        logarAdminButton.setOnAction(event -> loginAdministrador());
        cadastrarAlunoButton.setOnAction(event -> cadastrarRequisitante());
        cadastrarAdminButton.setOnAction(event -> cadastrarAdministrador());
    }

    private void loginRequisitante() {
        String login = loginAlunoField.getText();
        String senha = senhaAlunoField.getText();
        try {
            Requisitante requisitante = controller.requisitanteLogin(login, senha);
            showAlert("Login realizado com sucesso", "Bem-vindo, " + requisitante.getLogin());
        } catch (RuntimeException e) {
            showAlert("Erro", e.getMessage());
        }
    }

    private void loginAdministrador() {
        String login = loginAdminField.getText();
        String senha = senhaAdminField.getText();
        try {
            Administrador administrador = controller.administradorLogin(login, senha);
            showAlert("Login realizado com sucesso", "Bem-vindo, " + administrador.getLogin());
        } catch (RuntimeException e) {
            showAlert("Erro", e.getMessage());
        }
    }

    private void cadastrarRequisitante() {
        String login = loginAdminField.getText();
        String senha = senhaAdminField.getText();
        try {
            controller.cadastrarNovoRequisitante(login, senha);
            showAlert("Cadastro realizado com sucesso", "Requisitante cadastrado com sucesso!");
        } catch (RuntimeException e) {
            showAlert("Erro", e.getMessage());
        }
    }

    private void cadastrarAdministrador() {
        String login = loginAdminField.getText();
        String senha = senhaAdminField.getText();
        try {
            controller.cadastrarNovoAdministrador(login, senha);
            showAlert("Cadastro realizado com sucesso", "Administrador cadastrado com sucesso!");
        } catch (RuntimeException e) {
            showAlert("Erro", e.getMessage());
        }
    }

    // Método para exibir alertas
    private void showAlert(String title, String message) {
        Alert alert = new Alert(AlertType.INFORMATION);
        alert.setTitle(title);
        alert.setHeaderText(null);
        alert.setContentText(message);
        alert.showAndWait();
    }
}
